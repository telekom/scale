/**
 * @license
 * Scale https://github.com/telekom/scale
 *
 * Copyright (c) 2021 Egor Kirpichev and contributors, Deutsche Telekom AG
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */

scale-switch {
  --width: 42px;
  --height: 24px;
  --offset: 2px;
  --radius: 1em;
  --transition-duration: var(--telekom-motion-duration-immediate);
  --transition-easing: var(--telekom-motion-easing-standard);
  --shadow-thumb: var(--telekom-shadow-raised-standard);
  --spacing-x-label: var(--telekom-spacing-unit-x2);
  --font-label: var(--telekom-text-style-ui);
  --font-io-text: var(--telekom-text-style-small-bold);
}

.switch {
  --_background: var(--telekom-color-ui-faint);
  --_color-thumb: var(--telekom-color-ui-white, #fff);

  display: inline-block;
  position: relative;
}

/* <input> */
.switch__control {
  position: absolute;
  margin: 0;
  top: 0;
  width: var(--width);
  height: var(--height);
  opacity: 0;
}

/* <label> */
.switch__wrapper {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.switch__toggle {
  position: relative;
  width: var(--width);
  height: var(--height);
  background: var(--_background);
  border-radius: var(--radius);
  transition-property: background;
  transition-duration: var(--transition-duration);
  transition-timing-function: var(--transition-easing);
}

.switch:hover {
  --_background: var(--telekom-color-ui-regular);
}
.switch:active {
  --_background: var(--telekom-color-ui-strong);
}

.switch--checked {
  --_background: var(--telekom-color-primary-standard);
}
.switch--checked:hover {
  --_background: var(--telekom-color-primary-hovered);
}
.switch--checked.switch__control {
  --_background: var(--telekom-color-primary-pressed);
}

.switch--disabled,
.switch--disabled:hover,
.switch--disabled:active {
  --_background: var(--telekom-color-ui-disabled);
  --_color: var(--telekom-color-ui-faint);
}

.switch--disabled .switch__wrapper {
  cursor: not-allowed;
}

/*
  I think there's a selector combination that could
  replace .switch--focus-visible-not-supported and the JS check
*/

/* I don't like the ~ */
.switch--focus-visible-not-supported :focus ~ .switch__toggle,
:focus-visible ~ .switch__toggle {
  outline: var(--telekom-spacing-unit-x05) solid
    var(--telekom-color-functional-focus);
  outline-offset: var(--telekom-spacing-unit-x025);
}

.switch__thumb {
  --_size: calc(var(--height) - var(--offset) * 2);
  position: relative;
  z-index: 2;
  box-sizing: border-box;
  width: var(--_size);
  height: var(--_size);
  aspect-ratio: 1 / 1;
  background: var(--_color-thumb);
  border-radius: 50%;
  box-shadow: var(--shadow-thumb);
  margin: var(--offset);
  transition-property: margin;
  transition-duration: var(--transition-duration);
  transition-timing-function: var(--transition-easing);
  color: transparent;
}

.switch--checked .switch__thumb {
  margin-left: 1em;
  margin-inline-start: calc(var(--width) - var(--height) + var(--offset));
}

.switch__io-text {
  position: absolute;
  z-index: 1;
  top: 0;
  left: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 50%;
  height: var(--height);
  margin-left: calc(50% - var(--offset));
  font: var(--font-io-text);
  line-height: var(--telekom-typography-line-spacing-none);
}

.switch--checked .switch__io-text {
  margin-left: var(--offset);
  color: var(--telekom-color-text-and-icon-white-standard);
}

.switch--disabled .switch__io-text {
  color: var(--telekom-color-text-and-icon-disabled);
}

.switch__label-text {
  font: var(--font-label);
  margin-inline-start: var(--spacing-x-label);
}

/* PLATFORM iOS */

[data-platform='ios'] scale-switch {
  --width: 56px;
  --height: 32px;
}

/* PLATFORM Android */

[data-platform='android'] scale-switch {
  --width: 56px;
  --height: 32px;
  --offset: 4px;
}

[data-platform='android'] .switch__thumb {
  /* FIXME no color token for this :( */
  box-shadow: 0 0 0 var(--telekom-spacing-unit-x025) rgba(0, 0, 0, 0.05);
  display: flex;
  justify-content: center;
  align-items: center;
}

[data-platform='android'] .switch--checked .switch__thumb {
  color: var(--_background);
}

[data-platform='android'] .switch__io-text {
  display: none;
}
